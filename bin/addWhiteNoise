#!/bin/env python
from flipper import *

paramFile = sys.argv[1]
params = flipperDict.flipperDict()
params.readFromFile(paramFile)

lm = liteMap.liteMapFromFits(params["templateMap"])
radToMin = 180/numpy.pi*60
pixArea = radToMin**2 * lm.pixScaleX*lm.pixScaleY

rms = params["rmsArcmin"]/numpy.sqrt(pixArea)

noise = numpy.random.normal( scale = rms, size = lm.data.shape )

if params["addToTemplate"]:
    lm.data[:] += noise[:]
else:
    lm.data[:] = noise[:]

lm.writeFits(params["outputFits"])
